language: python
python:
- '3.8'
jobs:
  include:
  - before_install:
    - pip install --upgrade pip
    - pip install pipenv
install:
- python -m pipenv lock -r > requirements.txt
- pipenv install -r requirements.txt
script:
- pipenv run python -m unittest discover -v -p "*_test.py"
- pipenv run flake8
deploy:
  skip_cleanup: true
  provider: pypi
  user: __token__
  on:
    branch: master
  server: https://test.pypi.org/legacy/
  password:
    secure: $PYPI_PASSWORD_HASH
